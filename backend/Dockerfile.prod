FROM node:16-alpine

WORKDIR /app

# Installation des dépendances système
RUN apk add --no-cache \
    python3 \
    make \
    g++ \
    postgresql-dev

# Copier package.json et installer les dépendances
COPY package*.json ./
RUN npm install --production --no-optional

# Copier le code source
COPY . .

# Exposer le port
EXPOSE 5000

# Commande de démarrage
CMD ["node", "server.js"]
FROM node:16-alpine

WORKDIR /app

# Installation des dépendances
RUN apk add --no-cache \
    python3 \
    make \
    g++ \
    postgresql-dev

# Copier package.json et installer les dépendances
COPY package*.json ./
RUN npm install --omit=dev

# Copier le code source
COPY . .

# Exposer le port (Render utilise le port 10000)
EXPOSE 5000

# Commande de démarrage
CMD ["node", "server.js"]